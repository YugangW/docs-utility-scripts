---
title: blah
---
<script type="text/javascript">

var opts = {}

opts.success = function(data){

	data = fixImgPaths(data)

	$('main').html(data.split(/<\/?main.+?>/)[1])

}

opts.error = function(){ console.log ('error!!! wtf?? ')}

var path; 

$('a').click (function(e){
	e.preventDefault();
	var href = e.currentTarget.href;
	path = href.replace(/\/[^\/]*?\.html/, '/');
	// path = path.replace(/http:\/\/localhost:4567/, '')

	console.log("href: " + href);
	console.log("path: " + path);
	$.ajax(href, opts);

})

	

function fixImgPaths(text){
	var newImgPath;


	// var nextMatch = findNextImgPath(text);

	var imgPaths = findImgPaths(text);

	imgPaths.forEach(function(imgPath){
		newImgPath = path + imgPath;
		console.log("new path for next match: " + newImgPath)
		text = text.replace(imgPath, newImgPath);
	})

	// if (!!nextMatch){
		
	// 	console.log("next match!: " + nextMatch);

	// 	newImgPath = path + nextMatch;

	// 	console.log("new path for next match: " + newImgPath)

	// 	text = text.replace(nextMatch, newImgPath);
	// 	fixImgPaths(text);
	// }


	return text;

}

// function findNextImgPath(text){

// 	var imgRegX = /<.*?img.*?src.*?=.*?['"](.*?)['"]/;
// 	var img = imgRegX.exec(text);
// 	if (img == null) return null ;
// 	var imgPath = img[1];
// 	return imgPath; 
	
// }

function findImgPaths(thisText){
	var workingText = thisText;
	var imagePaths = []
	var imgRegX = /<.*?img.*?src.*?=.*?['"](.*?)['"]/;

	var nextImagePath = workingText.match(imgRegX);
	console.log("nextImagePath: " + nextImagePath)
	// while (!!nextImagePath){
	// 	// imagePaths.push(nextImagePath[1]);
	// 	// workingText.replace(nextImagePath, '')
	// 	// nextImagePath = workingText.match(imgRegX);		
	// 	nextImagePath = false;
	// }

	console.log(imagePaths);
	return imagePaths;

}



</script>